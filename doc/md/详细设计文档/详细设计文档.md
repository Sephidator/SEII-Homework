详细设计文档——<br/>灯具进销存管理系统<br/><br/>软工二小组
=========================



<br/>
<br/>
<br/>

# 更新历史
| **修改人员**           | **日期**     | **变更原因** | **版本** |
| ------------------ | ---------- | -------- | ------ |
| 陈骁、陈思彤、<br/>王宁、王颀涵 | 2017-10-29 | 最初版本     | V1.0   |

<br/>
<br/>
***********************************************
<br/>
<br/>

# 变更记录
| **修改人员**           | **日期**     | **变更原因** | **版本** | **变更内容** |
| ------------------ | ---------- | -------- | ------ | -------- |
| 陈骁、陈思彤、<br/>王宁、王颀涵 | 2017-10-29 | 初始版本     | V1.0   | 无        |

<br/>
<br/>
***********************************************
<br/>
<br/>

# 目录
<!-- TOC -->

- [更新历史](#更新历史)
- [变更记录](#变更记录)
- [目录](#目录)
- [1.引言](#1引言)
    - [1.1 编制目的](#11-编制目的)
- [2.产品概述](#2产品概述)
- [3.体系结构设计概述](#3体系结构设计概述)
- [4.结构视角](#4结构视角)
- [4.结构视角](#4结构视角-1)
    - [4.1 业务逻辑层的分解](#41-业务逻辑层的分解)
        - [4.1.1 goodssortbl模块](#411-goodssortbl模块)
            - [(1) 模块概述](#1-模块概述)
            - [(2) 整体结构](#2-整体结构)
            - [(3) 模块内部类的接口规范](#3-模块内部类的接口规范)
                - [GoodsSort的接口规范](#goodssort的接口规范)
            - [(4) 业务逻辑层的动态模型](#4-业务逻辑层的动态模型)
        - [4.1.2 goodsbl模块](#412-goodsbl模块)
            - [(1) 模块概述](#1-模块概述-1)
            - [(2) 整体结构](#2-整体结构-1)
            - [(3) 模块内部类的接口规范](#3-模块内部类的接口规范-1)
                - [Goods的接口规范](#goods的接口规范)
            - [(4) 业务逻辑层的动态模型](#4-业务逻辑层的动态模型-1)
        - [4.1.3 inventorybl模块](#413-inventorybl模块)
            - [(1) 模块概述](#1-模块概述-2)
            - [(2) 整体结构](#2-整体结构-2)
            - [(3) 模块内部类的接口规范](#3-模块内部类的接口规范-2)
                - [InventoryCheck的接口规范](#inventorycheck的接口规范)
                - [InventoryVerification的接口规范](#inventoryverification的接口规范)
                - [InventoryLossOverBill的接口规范](#inventorylossoverbill的接口规范)
                - [InventoryGiftBill的接口规范](#inventorygiftbill的接口规范)
            - [(4) 业务逻辑层的动态模型](#4-业务逻辑层的动态模型-2)
        - [4.1.4 Clientbl模块](#414-clientbl模块)
            - [(1) 模块概述](#1-模块概述-3)
            - [(2) 整体结构](#2-整体结构-3)
            - [(3) 模块内部类的接口规范](#3-模块内部类的接口规范-3)
                - [Client的接口规范](#client的接口规范)
            - [(4) 业务逻辑层的动态模型](#4-业务逻辑层的动态模型-3)
        - [4.1.5 purchasebl模块](#415-purchasebl模块)
            - [(1) 模块概述](#1-模块概述-4)
            - [(2) 整体结构](#2-整体结构-4)
            - [(3) 模块内部类的接口规范](#3-模块内部类的接口规范-4)
                - [PurchaseTradeBill的接口规范](#purchasetradebill的接口规范)
                - [PurchaseRefundBill的接口规范](#purchaserefundbill的接口规范)
            - [(4) 业务逻辑层的动态模型](#4-业务逻辑层的动态模型-4)
        - [4.1.6 salebl模块](#416-salebl模块)
            - [(1) 模块概述](#1-模块概述-5)
            - [(2) 整体结构](#2-整体结构-5)
            - [(3) 模块内部类的接口规范](#3-模块内部类的接口规范-5)
                - [SaleTradeBill的接口规范](#saletradebill的接口规范)
                - [SaleRefundBill的接口规范](#salerefundbill的接口规范)
            - [(4) 业务逻辑层的动态模型](#4-业务逻辑层的动态模型-5)
        - [4.1.7 accountbl模块](#417-accountbl模块)
            - [(1) 模块概述](#1-模块概述-6)
            - [(2) 整体结构](#2-整体结构-6)
            - [(3) 模块内部类的接口规范](#3-模块内部类的接口规范-6)
                - [Account的接口规范](#account的接口规范)
            - [(4) 业务逻辑层的动态模型](#4-业务逻辑层的动态模型-6)
        - [4.1.8 financebl模块](#418-financebl模块)
            - [(1) 模块概述](#1-模块概述-7)
            - [(2) 整体结构](#2-整体结构-7)
            - [(3) 模块内部类的接口规范](#3-模块内部类的接口规范-7)
                - [PaymentBill的接口规范](#paymentbill的接口规范)
                - [ReceiptBill的接口规范](#receiptbill的接口规范)
                - [CashBill的接口规范](#cashbill的接口规范)
            - [(4) 业务逻辑层的动态模型](#4-业务逻辑层的动态模型-7)
        - [4.1.9 initialbl模块](#419-initialbl模块)
            - [(1) 模块概述](#1-模块概述-8)
            - [(2) 整体结构](#2-整体结构-8)
            - [(3) 模块内部类的接口规范](#3-模块内部类的接口规范-8)
                - [Initial的接口规范](#initial的接口规范)
            - [(4) 业务逻辑层的动态模型](#4-业务逻辑层的动态模型-8)
        - [4.1.10 logbl模块](#4110-logbl模块)
            - [(1) 模块概述](#1-模块概述-9)
            - [(2) 整体结构](#2-整体结构-9)
            - [(3) 模块内部类的接口规范](#3-模块内部类的接口规范-9)
                - [Log的接口规范](#log的接口规范)
            - [(4) 业务逻辑层的动态模型](#4-业务逻辑层的动态模型-9)
        - [4.1.11 reportbl模块](#4111-reportbl模块)
            - [(1) 模块描述](#1-模块描述)
            - [(2) 整体结构](#2-整体结构-10)
            - [(3) 模块内部类的接口规范](#3-模块内部类的接口规范-10)
                - [SaleDetail的接口规范](#saledetail的接口规范)
                - [BusinessHistory的接口规范](#businesshistory的接口规范)
                - [BusinessCondition的接口规范](#businesscondition的接口规范)
            - [(4) 业务逻辑层的动态模型](#4-业务逻辑层的动态模型-10)
        - [4.1.12 approvalbl模块](#4112-approvalbl模块)
            - [(1) 模块描述](#1-模块描述-1)
            - [(2) 整体结构](#2-整体结构-11)
            - [(3) 模块内部类的接口规范](#3-模块内部类的接口规范-11)
            - [Approval的接口规范](#approval的接口规范)
            - [(4) 业务逻辑层的动态模型](#4-业务逻辑层的动态模型-11)
        - [4.1.13 promotionbl模块](#4113-promotionbl模块)
            - [(1) 模块描述](#1-模块描述-2)
            - [(2) 整体结构](#2-整体结构-12)
            - [(3) 模块内部类的接口规范](#3-模块内部类的接口规范-12)
                - [Promotion的接口规范](#promotion的接口规范)
            - [(4) 业务逻辑层的动态模型](#4-业务逻辑层的动态模型-12)
        - [4.1.14 userbl模块](#4114-userbl模块)
            - [(1) 模块描述](#1-模块描述-3)
            - [(2) 整体结构](#2-整体结构-13)
            - [(3) 模块内部类的接口规范](#3-模块内部类的接口规范-13)
                - [User的接口规范](#user的接口规范)
            - [(4)业务逻辑的动态模型](#4业务逻辑的动态模型)
        - [4.1.15 loginbl模块](#4115-loginbl模块)
            - [(1) 模块概述](#1-模块概述-10)
            - [(2) 整体结构](#2-整体结构-14)
            - [(3) 模块内部类的接口规范](#3-模块内部类的接口规范-14)
                - [Login的接口规范](#login的接口规范)
            - [(4) 业务逻辑层的动态模型](#4-业务逻辑层的动态模型-13)
        - [4.1.16 messagebl模块](#4116-messagebl模块)
            - [(1) 模块概述](#1-模块概述-11)
            - [(2) 整体结构](#2-整体结构-15)
            - [(3) 模块内部类的接口规范](#3-模块内部类的接口规范-15)
                - [Message的接口规范](#message的接口规范)
            - [(4) 业务逻辑层的动态模型](#4-业务逻辑层的动态模型-14)

<!-- /TOC -->

<br/>
<br/>
***********************************************
<br/>
<br/>

# 1.引言
## 1.1 编制目的
本报告详细完成灯具进销存管理系统的详细设计，达到指导后续软件构造的目的，同时实现和测试人员及用户的沟通。<br/>
本报告面向开发人员、测试人员及最终用户而编写，是了解系统的导航。

<br/>
<br/>
***********************************************
<br/>
<br/>

# 2.产品概述
参考灯具进销存管理系统用例文档和灯具进销存管理系统软件规格说明中对产品的概括描述。

<br/>
<br/>
***********************************************
<br/>
<br/>

# 3.体系结构设计概述
参考灯具进销存管理系统体系结构描述文档对体系结构设计的概述

<br/>
<br/>
***********************************************
<br/>
<br/>

# 4.结构视角
# 4.结构视角
## 4.1 业务逻辑层的分解
业务逻辑层的开发包图参见软件体系结构描述文档的图3

<br/>
<br/>
***********************************************
<br/>
<br/>

### 4.1.1 goodssortbl模块
#### (1) 模块概述
goodssortbl模块负责商品分类的管理，增加商品分类，删除商品分类，修改商品分类，查询商品分类。具体功能需求和非功能需求可参见需求规格说明文档和体系结构设计文档。

<br/>

#### (2) 整体结构
根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们会添加接口。比如展示层和业务逻辑层之间，我们添加bussinesslogicservice.GoodsSortBLlervice接口。业务逻辑层和数据层之间添加dataservice. GoodsSortDataService接口。GoodsSortPO是作为商品分类的持久化对象被添加到设计模型中去的。

goodssortbl模块的设计如图

![](pictures/goodssortbl/goodssortbl模块各个类的设计.png)

goodssortbl模块各个类的职责如下表所示

| goodssortbl模块的类 | 职责                   |
| --------------- | -------------------- |
| GoodsSort       | 负责实现商品分类管理管理界面所需要的服务 |

<br/>

#### (3) 模块内部类的接口规范
##### GoodsSort的接口规范
| 提供的服务（供接口）                               |      |                                          |
| ---------------------------------------- | ---- | ---------------------------------------- |
| `GoodsSortBlService/GoodsSortTool.getGoodsSortList` | 语法   | `public ArraytList<GoodsSortVO> getGoodsSortList(GoodsSortQueryVO query)` |
|                                          | 前置条件 | 正在进行商品分类管理                               |
|                                          | 后置条件 | 根据输入信息返回相应的商品分类                          |
| `GoodsSortBlService.addGoodsSort`        | 语法   | `public ResultMessage addGoodsSort(GoodsSortVO goodsSort)` |
|                                          | 前置条件 | 正在进行商品分类管理                               |
|                                          | 后置条件 | 添加一个商品分类，更新商品分类列表                        |
| `GoodsSortBlService.deleteGoodsSort`     | 语法   | `public ResultMessage deleteGoodsSort(GoodsSortVO goodsSort)` |
|                                          | 前置条件 | 正在进行商品分类管理                               |
|                                          | 后置条件 | 删除一个商品分类，更新商品分类列表                        |
| `GoodsSortBlService.editGoodsSort`       | 语法   | `public ResultMessage editGoodsSort(GoodsSortVO goodsSort)` |
|                                          | 前置条件 | 正在进行商品分类管理                               |
|                                          | 后置条件 | 编辑一个商品分类，更新商品分类列表                        |
| `GoodsSortBlService.getID`               | 语法   | `public String getID()`                  |
|                                          | 前置条件 | 商品分类已添加                                  |
|                                          | 后置条件 | 返回新商品分类ID                                |

| 需要的服务（需接口）                               |            |
| ---------------------------------------- | ---------- |
| 服务名                                      | 服务         |
| `GoodsSortDataService.find(GoodsSortQueryPO query)` | 取得持久化对象的列表 |
| `GoodsSortDataService.insert(GoodsSortPO po)` | 添加商品分类     |
| `GoodsSortDataService.delete(GoodsSortPO po)` | 删除商品分类     |
| `GoodsSortDataService.update(GoodsSortPO po)` | 修改单一持久化对象  |
| `GoodsSortDataService.getGoodsSortID()`  | 得到新的商品分类ID |
| `GoodsTool.getGoodsList(GoodsQueryVO query)` | 取得商品列表     |
| `LogTool.addLog(LogVO log)`              | 记录日志       |

<br/>

#### (4) 业务逻辑层的动态模型
如图表明了进销存管理系统中，当库存管理人员想要添加一个商品分类的时候，商品分类管理业务逻辑处理的相关对象之间的协作。

![](pictures/goodssortbl/添加商品分类的顺序图.png)

如图表明了进销存管理系统中，当库存管理人员想要删除一个商品分类的时候，商品分类管理业务逻辑处理的相关对象之间的协作。

![](pictures/goodssortbl/删除商品分类的顺序图.png)

如图所示的状态图描述了GoodsSort对象的生存期间的状态序列、引起转移的事件，以及因状态转移而伴随的动作。

![](pictures/goodssortbl/GoodsSort对象状态图.png)

<br/>
<br/>
***********************************************
<br/>
<br/>

### 4.1.2 goodsbl模块
#### (1) 模块概述
goodsbl模块负责商品的管理，增加商品，删除商品，修改商品，查询商品。具体功能需求和非功能需求可参见需求规格说明文档和体系结构设计文档。

<br/>

#### (2) 整体结构
根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们会添加接口。此包实现了goodsblservice的所有接口，并依赖goodsdataservice来获取data层的数据。GoodsPO是作为商品分类的持久化对象被添加到设计模型中去的。

goodsbl模块的设计如图

![](pictures/goodsbl/goodsbl模块各个类的设计.png)

goodsbl模块各个类的职责如下表所示

| goodsbl模块的类 | 职责                 |
| ----------- | ------------------ |
| Goods       | 负责实现商品管理管理界面所需要的服务 |

<br/>

#### (3) 模块内部类的接口规范
##### Goods的接口规范
| 提供的服务（供接口）                              |      |                                          |
| --------------------------------------- | ---- | ---------------------------------------- |
| `GoodsBlService/GoodsTool.getGoodsList` | 语法   | `public ArrayList<GoodsVo> getGoodsList(GoodsQueryVO query)` |
|                                         | 前置条件 | 正在进行商品管理                                 |
|                                         | 后置条件 | 返回商品列表                                   |
| `GoodsBlService.addGoods`               | 语法   | `public ResultMessage addGoods(GoodsVO goods)` |
|                                         | 前置条件 | 正在进行商品管理                                 |
|                                         | 后置条件 | 添加一个商品，更新商品列表                            |
| `GoodsBlService/GoodsTool.editGoods`    | 语法   | `public ResultMessage editGoods(GoodsVO goods)` |
|                                         | 前置条件 | 正在进行商品管理                                 |
|                                         | 后置条件 | 编辑一个商品，更新商品列表                            |
| `GoodsBlService.deleteGoods`            | 语法   | `public ResultMessage deleteGoods(GoodsVO goods)` |
|                                         | 前置条件 | 正在进行商品管理                                 |
|                                         | 后置条件 | 删除一个商品，更新商品列表                            |
| `GoodsBlService.getGoodsID`             | 语法   | `public String getGoodsID()`             |
|                                         | 前置条件 | 新建商品时                                    |
|                                         | 后置条件 | 返回一个新的商品ID                               |

| 需要的服务（需接口）                               |               |
| ---------------------------------------- | ------------- |
| 服务名                                      | 服务            |
| `GoodsDataService.find(GoodsQueryPO query)` | 根据筛选条件d进行查找商品 |
| `GoodsDataService.insert(GoodsPO po)`    | 添加商品          |
| `GoodsDataService.delete(GoodsPO po)`    | 删除商品          |
| `GoodsDataService.update(GoodsPO po)`    | 更改商品信息        |
| `GoodsDataService.getGoodsID()`          | 得到新的商品ID      |
| `LogTool.addLog(LogVO log)`              | 记录日志          |

<br/>

#### (4) 业务逻辑层的动态模型
如图表明了进销存管理系统中，当库存管理人员想要添加一个商品的时候，商品管理业务逻辑处理的相关对象之间的协作。

![](pictures/goodsbl/添加商品的顺序图.png)

如图表明了进销存管理系统中，当库存管理人员想要删除一个商品的时候，商品管理业务逻辑处理的相关对象之间的协作。

![](pictures/goodsbl/删除商品的顺序图.png)

如图所示的状态图描述了Goods对象的生存期间的状态序列、引起转移的事件，以及因状态转移而伴随的动作。

![](pictures/goodsbl/Goods对象状态图.png)

<br/>
<br/>
***********************************************
<br/>
<br/>

### 4.1.3 inventorybl模块
#### (1) 模块概述
inventorybl模块负责库存的管理，库存查看，库存盘点，建立库存溢损单。具体功能需求和非功能需求可参见需求规格说明文档和体系结构设计文档。

<br/>

#### (2) 整体结构
根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们会添加接口。InventoryPO，InventoryLossOverBillPO是作为库存的持久化对象被添加到设计模型中去的。

inventorybl模块的设计如图

![](pictures/inventorybl/inventorybl模块各个类的设计.png)

inventorybl模块各个类的职责如下表所示

| inventorybl模块的类       | 职责                  |
| --------------------- | ------------------- |
| InventoryCheck        | 负责实现库存查看界面所需要的服务    |
| InventoryVerification | 负责实现库存盘点界面所需要的服务    |
| InventoryLossOverBill | 负责实现建立库存溢损单界面所需要的服务 |
| InventoryGiftBill     | 负责实现建立库存赠送单界面所需要的服务 |

<br/>

#### (3) 模块内部类的接口规范
##### InventoryCheck的接口规范
| 提供的服务（供接口）                               |      |                                          |
| ---------------------------------------- | ---- | ---------------------------------------- |
| `InventoryCheckBlService.getImportNumber` | 语法   | `public int getImportNumber(Date start,Date end)` |
|                                          | 前置条件 | 正在进行库存查看，日期输入正确                          |
|                                          | 后置条件 | 返回对应的在此时间段内的入库商品数                        |
| `InventoryCheckBlService.getExportNumber` | 语法   | `public int getExportNumber(Date start,Date end)` |
|                                          | 前置条件 | 正在进行库存查看，日期输入正确                          |
|                                          | 后置条件 | 返回对应的在此时间段内的出库商品数                        |
| `InventoryCheckBlService.getImportAmount` | 语法   | `public getImportAmount(Date start,Date end)` |
|                                          | 前置条件 | 正在进行库存查看，日期输入正确                          |
|                                          | 后置条件 | 返回对应的在此时间段内的入库商品金额                       |
| `InventoryCheckBlService.getExportAmount` | 语法   | `public getExportAmount(Date start,Date end)` |
|                                          | 前置条件 | 正在进行库存查看，日期输入正确                          |
|                                          | 后置条件 | 返回对应的在此时间段内的出库商品金额                       |
| `InventoryCheckBlService.getPurchaseNumber` | 语法   | `public getPurchaseNumber(Date start,Date end)` |
|                                          | 前置条件 | 正在进行库存查看，日期输入正确                          |
|                                          | 后置条件 | 返回对应的在此时间段内的进货商品数                        |
| `InventoryCheckBlService.getPurchaseAmount` | 语法   | `public getPurchaseAmount(Date start,Date end)` |
|                                          | 前置条件 | 正在进行库存查看，日期输入正确                          |
|                                          | 后置条件 | 返回对应的在此时间段内的进货商金额                        |
| `InventoryCheckBlService.getSaleNumber`  | 语法   | `public getSaleNumber(Date start,Date end)` |
|                                          | 前置条件 | 正在进行库存查看，日期输入正确                          |
|                                          | 后置条件 | 返回对应的在此时间段内的销售商品数                        |
| `InventoryCheckBlService.getSaleAmount`  | 语法   | `public getSaleAmount(Date start,Date end)` |
|                                          | 前置条件 | 正在进行库存查看，日期输入正确                          |
|                                          | 后置条件 | 返回对应的在此时间段内的销售商金额                        |

| 需要的服务（需接口）                               |           |
| ---------------------------------------- | --------- |
| 服务名                                      | 服务        |
| `PurchaseTradeBillTool.getPurchaseTradeBillList(BillQueryVO query)` | 取得进货单列表   |
| `PurchaseRefundBillTool.getPurchaseRefundBillList(BillQueryVO query)` | 取得进货退货单列表 |
| `SaleTradeBillTool.getSaleTradeBillList(BillQueryVO query)` | 取得销售单列表   |
| `SaleRefundBillTool.getSaleRefundBillList(BillQueryVO query)` | 取得进货单列表   |
<br/>

##### InventoryVerification的接口规范
| 提供的服务（供接口）                           |      |                                          |
| ------------------------------------ | ---- | ---------------------------------------- |
| `InventoryVerification.getGoodsList` | 语法   | `public ArrayList<GoodsVO> getGoodsList(GoodsQueryVO query)` |
|                                      | 前置条件 | 无                                        |
|                                      | 后置条件 | 得到库存数据                                   |

| 需要的服务（需接口）                               |        |
| ---------------------------------------- | ------ |
| 服务名                                      | 服务     |
| `GoodsTool.getGoodsList(GoodsQueryVO query)` | 取得商品列表 |

<br/>

##### InventoryLossOverBill的接口规范
| 提供的服务（供接口）                               |      |                                          |
| ---------------------------------------- | ---- | ---------------------------------------- |
| `InventoryLossOverBillBlService.getID`   | 语法   | `public String getID()`                  |
|                                          | 前置条件 | 得到库存单据数据                                 |
|                                          | 后置条件 | 返回对应单据的ID                                |
| `InventoryLossOverBillBlService.getGoodList(GoodsQueryVO query)` |      |                                          |
|                                          | 前置条件 | 得到库存单据数据                                 |
|                                          | 后置条件 | 返回对应商品列表                                 |
| `InventoryLossOverBillBlService.submit`  | 语法   | `public ResultMessage submit(InventoryLossOverBillVO bill)` |
|                                          | 前置条件 | 制定单据完成                                   |
|                                          | 后置条件 | 单据被提交发送给经理进行审批                           |
| `InventoryLossOverBillBlService.saveDraft` | 语法   | `public ResultMessage saveDraft(InventoryLossOverBillVO bill)` |
|                                          | 前置条件 | 制定单据完成                                   |
|                                          | 后置条件 | 保存单据草稿                                   |
| `InventoryLossOverBillTool.pass`         | 语法   | `public ResultMessage pass(InventoryLossOverBillVO bill)` |
|                                          | 前置条件 | 单据审批通过                                   |
|                                          | 后置条件 | 更新客户应收应付信息，更改库存，修改单据状态                   |
| `InventoryLossOverBillTool.reject`       | 语法   | `public ResultMessage reject(InventoryLossOverBillVO bill)` |
|                                          | 前置条件 | 单据审批不通过                                  |
|                                          | 后置条件 | 修改单据状态为不通过                               |
| `InventoryLossOverBillBlService/InventoryLossOverBillTool.getInventoryLossOverBillList` | 语法   | `public ArrayList<InventoryLossOverBillVO> getInventoryLossOverBillList(BillQueryVO query)` |
|                                          | 前置条件 | 无                                        |
|                                          | 后置条件 | 取得进货单列表                                  |

| 需要的服务（需接口）                               |                     |
| ---------------------------------------- | ------------------- |
| 服务名                                      | 服务                  |
| `InventoryLossOverBillDataService.find()` | 根据ID与名称查找匹配的单一持久化对象 |
| `InventoryLossOverBillDataService.insert(InventoryLossOverBillPO bill)` | 添加单据                |
| `InventoryLossOverBillDataService.update(InventoryLossOverBillPO bill)` | 修改单据                |
| `GoodsTool.getGoodsList(GoodsQueryVO query)` | 取得商品列表              |
| `LogTool.addLog(LogVO log)`              | 记录日志                |
| `GoodsTool.editGoods(GoodsVO goods)`     | 取得商品列表              |

<br/>

##### InventoryGiftBill的接口规范
| 提供的服务（供接口）                               |      |                                          |
| ---------------------------------------- | ---- | ---------------------------------------- |
| `InventoryGiftBillBlService.getID`       | 语法   | `public String getID()`                  |
|                                          | 前置条件 | 得到库存单据数据                                 |
|                                          | 后置条件 | 返回对应单据的ID                                |
| `InventoryGiftBillBlService.getGoodList(GoodsQueryVO query)` |      |                                          |
|                                          | 前置条件 | 得到库存单据数据                                 |
|                                          | 后置条件 | 返回对应商品列表                                 |
| `InventoryGiftBillBlService.getClientList(ClientQueryVO query)` |      |                                          |
|                                          | 前置条件 | 得到库存单据数据                                 |
|                                          | 后置条件 | 返回对应商品列表                                 |
| `InventoryGiftBillBlService.submit`      | 语法   | `public ResultMessage submit(InventoryGiftBillVO bill)` |
|                                          | 前置条件 | 制定单据完成                                   |
|                                          | 后置条件 | 单据被提交发送给经理进行审批                           |
| `InventoryGiftBillBlService.saveDraft`   | 语法   | `public ResultMessage saveDraft(InventoryGiftBillVO bill)` |
|                                          | 前置条件 | 制定单据完成                                   |
|                                          | 后置条件 | 保存单据草稿                                   |
| `InventoryLossOverBillTool.pass`         | 语法   | `public ResultMessage pass(InventoryGiftBillVO bill)` |
|                                          | 前置条件 | 单据审批通过                                   |
|                                          | 后置条件 | 更新客户应收应付信息，更改库存，修改单据状态                   |
| `InventoryLossOverBillTool.reject`       | 语法   | `public ResultMessage reject(InventoryGiftBillVO bill)` |
|                                          | 前置条件 | 单据审批不通过                                  |
|                                          | 后置条件 | 修改单据状态为不通过                               |
| `InventoryGiftBillBlService/InventoryGiftBillTool.getInventoryGiftBillList` | 语法   | `public ArrayList<InventoryGiftBillVO> getInventoryGiftBillList(BillQueryVO query)` |
|                                          | 前置条件 | 无                                        |
|                                          | 后置条件 | 取得进货单列表                                  |

| 需要的服务（需接口）                               |                 |
| ---------------------------------------- | --------------- |
| 服务名                                      | 服务              |
| `InventoryGiftBillDataService.find(InventoryGiftBillPO bill)` | 根据筛选条件返回库存赠送单列表 |
| `InventoryGiftBillDataService.insert(InventoryGiftBillPO bill)` | 添加单据            |
| `InventoryGiftBillDataService.update(InventoryGiftBillPO bill)` | 修改单据            |
| `GoodsTool.getGoodsList(GoodsQueryVO query)` | 取得商品列表          |
| `LogTool.addLog(LogVO log)`              | 记录日志            |
| `GoodsTool.editGoods(GoodsVO goods)`     | 取得商品列表          |


<br/>

#### (4) 业务逻辑层的动态模型
如图表明了进销存管理系统中，当库存管理人员想要库存查看得到出库数量的时候，库存查看业务逻辑处理的相关对象之间的协作。

![](pictures/inventorybl/库存查看得到出库数量的顺序图.png)

如图表明了进销存管理系统中，当库存管理人员想要取得商品列表的时候，建立库存溢损单业务逻辑处理的相关对象之间的协作。

![](pictures/inventorybl/取得商品列表的顺序图.png)

如图所示的状态图描述了Inventory对象的生存期间的状态序列、引起转移的事件，以及因状态转移而伴随的动作。

![](pictures/inventorybl/Inventory对象状态图.png)

<br/>
<br/>
***********************************************
<br/>
<br/>

### 4.1.4 Clientbl模块
#### (1) 模块概述
Clientbl模块负责客户的管理，创建新的客户，删除客户，修改客户，查找客户。具体功能需求和非功能需求可参见需求规格说明文档和体系结构设计文档。

<br/>

#### (2) 整体结构
根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们会添加接口。比如展示层和业务逻辑层之间，我们添加bussinesslogicservice.ClientBLlervice接口。业务逻辑层和数据层之间添加dataservice.ClientDataService接口。ClientPO是作为客户的持久化对象被添加到设计模型中去的。

clientbl模块的设计如图

![](pictures/clientbl/clientbl模块各个类的设计.png)

client模块各个类的职责如下表所示
| clientbl模块的类 | 职责            |
| ------------ | ------------- |
| Client       | 负责实现客户信息的增删改查 |

<br/>

#### (3) 模块内部类的接口规范
##### Client的接口规范
| 提供的服务（供接口）                               |      |                                          |
| ---------------------------------------- | ---- | ---------------------------------------- |
| `ClientBlService/ClientTool.getClientList` | 语法   | `public ArrayList<ClientVo> getClientList(ClientQueryVO query)` |
|                                          | 前置条件 | 正在进行客户管理                                 |
|                                          | 后置条件 | 返回客户列表                                   |
| `ClientBlService.addClient`              | 语法   | `public ResultMessage addClient(ClientVO client)` |
|                                          | 前置条件 | 正在进行客户管理                                 |
|                                          | 后置条件 | 添加一个客户，更新客户列表                            |
| `ClientBlService/ClientTool.editClient`  | 语法   | `public ResultMessage editClient(ClientVO client)` |
|                                          | 前置条件 | 正在进行客户管理                                 |
|                                          | 后置条件 | 编辑一个客户，更新客户列表                            |
| `ClientBlService.deleteClient`           | 语法   | `public ResultMessage deleteClient(ClientVO client)` |
|                                          | 前置条件 | 正在进行客户管理                                 |
|                                          | 后置条件 | 删除一个客户，更新客户列表                            |
| `ClientBlService.getClientID`            | 语法   | `public String getClientID()`            |
|                                          | 前置条件 | 新建客户时                                    |
|                                          | 后置条件 | 返回一个新的客户ID                               |

| 需要的服务（需接口）                               |              |
| ---------------------------------------- | ------------ |
| 服务名                                      | 服务           |
| `ClientDataService.find(ClientQueryPO query)` | 根据筛选条件进行查找客户 |
| `ClientDataService.insert(ClientPO po)`  | 添加客户         |
| `ClientDataService.delete(ClientPO po)`  | 删除客户         |
| `ClientDataService.update(ClientPO po)`  | 更改客户信息       |
| `ClientDataService.getID()`        | 得到新的客户ID     |

<br/>

#### (4) 业务逻辑层的动态模型
如图表明了进销存管理系统中，当进货销售人员想要添加一个客户的时候，客户管理业务逻辑处理的相关对象之间的协作。

![](pictures/clientbl/添加客户的顺序图.png)

如图表明了进销存管理系统中，当进货销售人员想要删除一个客户的时候，客户管理业务逻辑处理的相关对象之间的协作。

![](pictures/clientbl/删除客户的顺序图.png)

如图所示的状态图描述了Client对象的生存期间的状态序列、引起转移的事件，以及因状态转移而伴随的动作。

![](pictures/clientbl/Client对象状态图.png)

<br/>
<br/>
***********************************************
<br/>
<br/>

### 4.1.5 purchasebl模块
#### (1) 模块概述
purchasebl模块负责进货单、进货退货单的创建。具体功能需求和非功能需求可参见需求规格说明文档和体系结构设计文档。

<br/>

#### (2) 整体结构
根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。此模块实现了purchaseui所要求的purchasebl包的所有接口，并通过purchasedataservice和data层进行交互。PurchaseTradeBillPO以及PurchaseRefundBillPO是作为单据的持久化对象被添加到设计模型中去的。

purchasebl模块的设计如图

![](pictures/purchasebl/purchasebl模块各个类的设计.png)

purchasebl模块各个类的职责如下表所示
| purchase模块的类       | 职责                |
| ------------------ | ----------------- |
| PurchaseTradeBill  | 负责实现制定进货单界面所需要的服务 |
| PurchaseRefundBill | 负责实现制定进货单界面所需要的服务 |

<br/>

#### (3) 模块内部类的接口规范
##### PurchaseTradeBill的接口规范
| 提供的服务（供接口）                               |      |                                          |
| ---------------------------------------- | ---- | ---------------------------------------- |
| `PurchaseTradeBillBlService.getID`       | 语法   | `public String getID ()`                 |
|                                          | 前置条件 | 开始制定进货单                                  |
|                                          | 后置条件 | 返回单据ID                                   |
| `PurchaseTradeBillBlService.getSupplierList` | 语法   | `public ArrayList<ClientVO> getSupplierList(ClientQueryVO query)` |
|                                          | 前置条件 | 开始制定进货单                                  |
|                                          | 后置条件 | 返回客户列表                                   |
| `PurchaseTradeBillService.getGoodsList`  | 语法   | `public ArrayList<GoodsVO> getGoodsList(GoodsQueryVO query)` |
|                                          | 前置条件 | 开始制定进货单                                  |
|                                          | 后置条件 | 返回商品列表                                   |
| `PurchaseTradeBillBlService.submit`      | 语法   | `public ResultMessage submit(PurchaseTradeBillVO bill)` |
|                                          | 前置条件 | 制定单据完成                                   |
|                                          | 后置条件 | 单据被提交发送给经理进行审批                           |
| `PurchaseTradeBillBlService.saveDraft`   | 语法   | `public ResultMessage saveDraft(PurchaseTradeBillVO bill)` |
|                                          | 前置条件 | 制定单据完成                                   |
|                                          | 后置条件 | 保存单据草稿                                   |
| `PurchaseTradeBillTool.pass`             | 语法   | `public ResultMessage pass(PurchaseTradeBillVO bill)` |
|                                          | 前置条件 | 单据审批通过                                   |
|                                          | 后置条件 | 更新客户应收应付信息，更改库存，修改单据状态                   |
| `PurchaseTradeBillTool.reject`           | 语法   | `public ResultMessage reject(PurchaseTradeBillVO bill)` |
|                                          | 前置条件 | 单据审批不通过                                  |
|                                          | 后置条件 | 修改单据状态为不通过                               |
| `PurchaseTradeBillBlService/PurchaseTradeBillTool.getPurchaseTradeBillList` | 语法   | `public ArrayList<PurchaseTradeBillVO> getPurchaseTradeBillList(BillQueryVO query)` |
|                                          | 前置条件 | 无                                        |
|                                          | 后置条件 | 取得进货单列表                                  |

| 需要的服务（需接口）                               |           |
| ---------------------------------------- | --------- |
| 服务名                                      | 服务        |
| `PurchaseTradeBillDataService.find(BillQueryPO query)` | 取得进货单列表   |
| `PurchaseTradeBillDataService.getID()`   | 得到新的进货单ID |
| `PurchaseTradeBillDataService.insert(PurchaseTradeBillPO po)` | 添加进货单     |
| `PurchaseTradeBillDataService.update(PurchaseTradeBillPO po)` | 修改进货单     |
| `ClientTool.getClientList(ClientQueryVO query)` | 取得客户列表    |
| `GoodsTool.getGoodsList(GoodsQueryVO query)` | 取得商品列表    |
| `LogPoerate.addLog(LogVO log)`           | 记录日志      |
| `ClientTool.editClient(ClientVO client)` | 更改客户信息    |
| `GoodsTool.editGoods(GoodsVO goods)`     | 更改在库商品数   |

<br/>

##### PurchaseRefundBill的接口规范
| 提供的服务（供接口）                               |      |                                          |
| ---------------------------------------- | ---- | ---------------------------------------- |
| `PurchaseRefundBillBlService.getID`      | 语法   | `public String getID ()`                 |
|                                          | 前置条件 | 开始制定进货退货单                                |
|                                          | 后置条件 | 返回单据ID                                   |
| `PurchaseRefundBillBlService.getSupplierList` | 语法   | `public ArrayList<ClientVO> getSupplierList(ClientQueryVO query)` |
|                                          | 前置条件 | 开始制定进货退货单                                |
|                                          | 后置条件 | 返回客户列表                                   |
| `PurchaseRefundBillService.getGoodsList` | 语法   | `public ArrayList<GoodsVO> getGoodsList(GoodsQueryVO query)` |
|                                          | 前置条件 | 开始制定进货退货单                                |
|                                          | 后置条件 | 返回商品列表                                   |
| `PurchaseRefundBillBlService.submit`     | 语法   | `public ResultMessage submit(PurchaseRefundBillVO bill)` |
|                                          | 前置条件 | 制定单据完成                                   |
|                                          | 后置条件 | 单据被提交发送给经理进行审批                           |
| `PurchaseRefundBillBlService.saveDraft`  | 语法   | `public ResultMessage saveDraft(PurchaseRefundBillVO bill)` |
|                                          | 前置条件 | 制定单据完成                                   |
|                                          | 后置条件 | 保存单据草稿                                   |
| `PurchaseRefundBillTool.pass`            | 语法   | `public ResultMessage pass(PurchaseRefundBillVO bill)` |
|                                          | 前置条件 | 单据审批通过                                   |
|                                          | 后置条件 | 更新客户应收应付信息，更改库存，修改单据状态                   |
| `PurchaseRefundBillTool.reject`          | 语法   | `public ResultMessage reject(PurchaseRefundBillVO bill)` |
|                                          | 前置条件 | 单据审批不通过                                  |
|                                          | 后置条件 | 修改单据状态为不通过                               |
| `PurchaseRefundBilllService/PurchaseRefundBillTool.getPurchaseRefudnBillList` | 语法   | `public ArrayList<PurchaseRefundBillVO> getPurchaseRefundBillList(BillQueryVO query)` |
|                                          | 前置条件 | 无                                        |
|                                          | 后置条件 | 取得进货退货单列表                                |

| 需要的服务（需接口）                               |           |
| ---------------------------------------- | --------- |
| 服务名                                      | 服务        |
| `PurchaseRefundBillDataService.find(BillQueryPO query)` | 取得进货单列表   |
| `PurchaseRefundBillDataService.getID()`  | 得到新的进货单ID |
| `PurchaseRefundBillDataService.insert(PurchaseRefundBillPO po)` | 添加进货单     |
| `PurchaseRefundBillDataService.update(PurchaseRefundBillPO po)` | 添加进货单     |
| `CLientTool.getClientList(ClientQueryVO query)` | 取得客户列表    |
| `GoodsTool.getGoodsList(GoodsQueryVO query)` | 取得商品列表    |
| `LogPoerate.addLog(LogVO log)`           | 记录日志      |
| `ClientTool.editClient(ClientVO client)` | 更改客户信息    |
| `GoodsTool.editGoods(GoodsVO goods)`     | 更改在库商品数   |

<br/>

#### (4) 业务逻辑层的动态模型
如图表明了进销存管理系统中，当制定进货销售单需要取得商品列表的时候，制定进货单业务逻辑处理的相关对象之间的协作。

![](pictures/purchasebl/取得商品列表的顺序图.png)

如图表明了进销存管理系统中，当进货销售人员想要提交进货单的时候，制定进货单业务逻辑处理的相关对象之间的协作。

![](pictures/purchasebl/提交进货单的顺序图.png)

如图所示的状态图描述了Purchase对象生存期间的状态序列、引起转移的事件，以及因状态转移而伴随的动作。

![](pictures/purchasebl/Purchase对象状态图.png)

<br/>
<br/>
***********************************************
<br/>
<br/>

### 4.1.6 salebl模块
#### (1) 模块概述
salebl模块负责销售单、销售退货单的创建。具体功能需求和非功能需求可参见需求规格说明文档和体系结构设计文档。

<br/>

#### (2) 整体结构
根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。此模块实现了saleui所要求的salebl包的所有接口，并通过saledataservice和data层进行交互。SaleTradeBillPO以及SaleRefundBillPO是作为单据的持久化对象被添加到设计模型中去的。

salebl模块的设计如图

![](pictures/salebl/salebl模块各个类的设计.png)

salebl模块各个类的职责如下表所示
| sale模块的类       | 职责                |
| -------------- | ----------------- |
| SaleTradeBill  | 负责实现制定销售单界面所需要的服务 |
| SaleRefundBill | 负责实现制定销售单界面所需要的服务 |

<br/>

#### (3) 模块内部类的接口规范
##### SaleTradeBill的接口规范
| 提供的服务（供接口）                               |      |                                          |
| ---------------------------------------- | ---- | ---------------------------------------- |
| `SaleTradeBillBlService.getID`           | 语法   | `public String getID ()`                 |
|                                          | 前置条件 | 开始制定销售单                                  |
|                                          | 后置条件 | 返回单据ID                                   |
| `SaleTradeBillBlService.getSellerList`   | 语法   | `public ArrayList<ClientVO> getSellerList(ClientQueryVO query)` |
|                                          | 前置条件 | 开始制定销售单                                  |
|                                          | 后置条件 | 返回客户列表                                   |
| `SaleTradeBillService.getGoodsList`      | 语法   | `public ArrayList<goodsVO> getGoodsList(GoodsQueryVO query)` |
|                                          | 前置条件 | 开始制定销售单                                  |
|                                          | 后置条件 | 返回商品列表                                   |
| `SaleTradeBillService.getSalesmanList`      | 语法   | `public ArrayList<UserVO> getSalesmanList(UserVO query)` |
|                                          | 前置条件 | 开始制定销售单                                  |
|                                          | 后置条件 | 返回业务员列表                                   |
| `SaleTradeBillService.getPromotitonList` | 语法   | `public ArrayList<PromotionVO> getPromotionList(PromotionQueryVO query)` |
|                                          | 前置条件 | 开始制定销售单                                  |
|                                          | 后置条件 | 返回符合的促销策略列表                              |
| `SaleTradeBillBlService.submit`          | 语法   | `public ResultMessage submit(SaleTradeBillVO bill)` |
|                                          | 前置条件 | 制定单据完成                                   |
|                                          | 后置条件 | 单据被提交发送给经理进行审批                           |
| `SaleTradeBillBlService.saveDraft`       | 语法   | `public ResultMessage saveDraft(SaleTradeBillVO bill)` |
|                                          | 前置条件 | 制定单据完成                                   |
|                                          | 后置条件 | 保存单据草稿                                   |
| `SaleTradeBillTool.pass`                 | 语法   | `public ResultMessage pass(SaleTradeBillVO bill)` |
|                                          | 前置条件 | 单据审批通过                                   |
|                                          | 后置条件 | 更新客户应收应付信息，更改库存，修改单据状态                   |
| `SaleTradeBillTool.reject`               | 语法   | `public ResultMessage reject(SaleTradeBillVO bill)` |
|                                          | 前置条件 | 单据审批不通过                                  |
|                                          | 后置条件 | 修改单据状态为不通过                               |
| `SaleTradeBillBlService/SaleTradeBillTool.getSaleTradeBillList` | 语法   | `public ArrayList<SaleTradeBillVO> getSaleTradeBillList(BillQueryVO query)` |
|                                          | 前置条件 | 无                                        |
|                                          | 后置条件 | 取得销售单列表                                  |


| 需要的服务（需接口）                               |           |
| ---------------------------------------- | --------- |
| 服务名                                      | 服务        |
| `SaleTradeBillDataService.find(BillQueryPO query)` | 取得销售单列表   |
| `SaleTradeBillDataService.getID()`       | 得到新的销售单ID |
| `SaleTradeBillDataService.insert(SaleTradeBillPO po)` | 添加销售单     |
| `SaleTradeBillDataService.update(SaleTradeBillPO po)` | 添加销售单     |
| `CLientTool.getClientList(ClientQueryVO query)` | 取得客户列表    |
| `GoodsTool.getGoodsList(GoodsQueryVO query)` | 取得商品列表    |
| `UserTool.getUserList(UserQueryVO query)` | 取得业务员列表    |
| `PromotionTool.getPromotionList(PromotionQueryVO query)` | 取得促销策略列表  |
| `LogPoerate.addLog(LogVO log)`           | 记录日志      |
| `ClientTool.editClient(ClientVO client)` | 更改客户信息    |
| `GoodsTool.editGoods(GoodsVO goods)`     | 更改在库商品数   |

<br/>

##### SaleRefundBill的接口规范
| 提供的服务（供接口）                               |      |                                          |
| ---------------------------------------- | ---- | ---------------------------------------- |
| `SaleRefundBillBlService.getID`          | 语法   | `public String getID ()`                 |
|                                          | 前置条件 | 开始制定销售退货单                                |
|                                          | 后置条件 | 返回单据ID                                   |
| `SaleRefundBillBlService.getSellerList`  | 语法   | `public ArrayList<ClientVO> getSellerList(ClientQueryVO query)` |
|                                          | 前置条件 | 开始制定销售退货单                                |
|                                          | 后置条件 | 返回客户列表                                   |
| `SaleRefundBillService.getGoodsList`     | 语法   | `public ArrayList<GoodsVO> getGoodsList(GoodsQueryVO query)` |
|                                          | 前置条件 | 开始制定销售退货单                                |
|                                          | 后置条件 | 返回商品列表                                   |
| `SaleRefundBillService.getSalesmanList`      | 语法   | `public ArrayList<UserVO> getSalesmanList(UserVO query)` |
|                                          | 前置条件 | 开始制定销售退货单                                  |
|                                          | 后置条件 | 返回业务员列表                                   |
| `SaleRefundBillBlService.submit`         | 语法   | `public ResultMessage submit(SaleRefundBillVO bill)` |
|                                          | 前置条件 | 制定单据完成                                   |
|                                          | 后置条件 | 单据被提交发送给经理进行审批                           |
| `SaleRefundBillBlService.saveDraft`      | 语法   | `public ResultMessage saveDraft(SaleRefundBillVO bill)` |
|                                          | 前置条件 | 制定单据完成                                   |
|                                          | 后置条件 | 保存单据草稿                                   |
| `SaleRefundBillTool.pass`                | 语法   | `public ResultMessage pass(SaleRefundBillVO bill)` |
|                                          | 前置条件 | 单据审批通过                                   |
|                                          | 后置条件 | 更新客户应收应付信息，更改库存，修改单据状态                   |
| `SaleRefundBillTool.reject`              | 语法   | `public ResultMessage reject(SaleRefundBillVO bill)` |
|                                          | 前置条件 | 单据审批不通过                                  |
|                                          | 后置条件 | 修改单据状态为不通过                               |
| `SaleRefundBilllService/SaleRefundBillTool.getSaleRefudnBillList` | 语法   | `public ArrayList<SaleRefundBillVO> getSaleRefundBillList(BillQueryVO query)` |
|                                          | 前置条件 | 无                                        |
|                                          | 后置条件 | 取得销售退货单列表                                |

| 需要的服务（需接口）                               |           |
| ---------------------------------------- | --------- |
| 服务名                                      | 服务        |
| `SaleRefundBillDataService.find(BillQueryPO query)` | 取得销售单列表   |
| `SaleRefundBillDataService.getID()`      | 得到新的销售单ID |
| `SaleRefundBillDataService.insert(SaleRefundBillPO po)` | 添加销售单     |
| `SaleRefundBillDataService.update(SaleRefundBillPO po)` | 更新销售单     |
| `ClientTool.getClientList(ClientQueryVO query)` | 取得客户列表    |
| `GoodsTool.getGoodsList(GoodsQueryVO query)` | 取得商品列表    |
| `UserTool.getUserList(UserQueryVO query)` | 取得业务员列表    |
| `LogPoerate.addLog(LogVO log)`           | 记录日志      |
| `ClientTool.editClient(ClientVO client)` | 更改客户信息    |
| `GoodsTool.editGoods(GoodsVO goods)`     | 更改在库商品数   |

<br/>

#### (4) 业务逻辑层的动态模型
如图表明了进销存管理系统中，当制定销售单需要取得商品列表的时候，制定销售单业务逻辑处理的相关对象之间的协作。

![](pictures/salebl/取得商品列表的顺序图.png)

如图表明了进销存管理系统中，当进货销售人员想要提交销售单的时候，制定销售单业务逻辑处理的相关对象之间的协作。

![](pictures/salebl/提交销售单的顺序图.png)

如图所示的状态图描述了Sale对象生存期间的状态序列、引起转移的事件，以及因状态转移而伴随的动作。

![](pictures/salebl/Sale对象状态图.png)

<br/>
<br/>
***********************************************
<br/>
<br/>

### 4.1.7 accountbl模块
#### (1) 模块概述
accountbl模块负责公司账户的查找、添加、删除和账户属性的修改。具体功能需求和非功能需求可参见需求规格说明文档和体系结构设计文档。

<br/>

#### (2) 整体结构
根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们会添加接口。比如展示层和业务逻辑层之间，我们添加bussinesslogicservice.AccountBlService接口。业务逻辑层和数据层之间添加dataservice.AccountDataService接口。实现的AccountTool是对外提供查询和修改Account的方法的接口.bussinesslogic.logbl.LogTool是需要依赖的接口.

accountbl模块的设计如图

![](pictures/accountbl/accountbl模块各个类的设计.png)

accountbl模块各个类的职责如下表所示

| accountbl模块的类 | 职责               |
| ------------- | ---------------- |
| Account       | 负责实现账户管理界面所需要的服务 |

<br/>

#### (3) 模块内部类的接口规范
##### Account的接口规范
| 提供的服务（供接口）                               |      |                                          |
| ---------------------------------------- | ---- | ---------------------------------------- |
| `AccountBlService/AccountTool.getAccountList` | 语法   | `public ArrayList<AccountVO> getAccountList(AccountQueryVO query)` |
|                                          | 前置条件 | 正在进行账户管理                                 |
|                                          | 后置条件 | 返回账户列表                                   |
| `AccountBlService.getID`                 | 语法   | `public String getID()`                  |
|                                          | 前置条件 | 正在进行账户管理                                 |
|                                          | 后置条件 | 返回账户ID                                   |
| `AccountBlService.addAccount`            | 语法   | `public ResultMessage addAccount(AccountVO account)` |
|                                          | 前置条件 | 正在进行账户管理                                 |
|                                          | 后置条件 | 添加一个账户，更新账户列表                            |
| `AccountBlService/AccountTool.editAccount` | 语法   | `public ResultMessage editAccount(AccountVO account)` |
|                                          | 前置条件 | 正在进行账户管理                                 |
|                                          | 后置条件 | 编辑一个账户，更新账户列表                            |
| `AccountBlService.deleteAccount`         | 语法   | `public ResultMessage deleteAccount(AccountVO account)` |
|                                          | 前置条件 | 正在进行账户管理                                 |
|                                          | 后置条件 | 删除一个账户，更新账户列表                            |

| 需要的服务（需接口）                               |              |
| ---------------------------------------- | ------------ |
| 服务名                                      | 服务           |
| `AccountDataService.find(AccountQueryPO query)` | 根据筛选条件进行查找账户 |
| `AccountDataService.getID()`             | 取得账户ID       |
| `AccountDataService.insert(AccountPO po)` | 添加账户         |
| `AccountDataService.delete(AccountPO po)` | 删除账户         |
| `AccountDataService.update(AccountPO po)` | 更改账户信息       |
| `LogTool.addLog(LogVO log)`              | 记录日志         |


<br/>

#### (4) 业务逻辑层的动态模型
如图表明了进销存管理系统中，当财务人员想要添加一个账户的时候，账户管理业务逻辑处理的相关对象之间的协作。

![](pictures/accountbl/添加账户的顺序图.png)

如图表明了进销存管理系统中，当财务人员想要删除一个账户的时候，账户管理业务逻辑处理的相关对象之间的协作。

![](pictures/accountbl/删除账户的顺序图.png)

如图所示的状态图描述了Account对象的生存期间的状态序列、引起转移的事件，以及因状态转移而伴随的动作。

![](pictures/accountbl/Account对象状态图.png)

<br/>
<br/>
***********************************************
<br/>
<br/>

### 4.1.8 financebl模块
#### (1) 模块概述
financebl模块负责财务类单据（包括收款单、付款单、现金费用单）的创建和修改以及提交。具体功能需求和非功能需求可参见需求规格说明文档和体系结构设计文档。

<br/>

#### (2) 整体结构
根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们会添加接口。此包实现了financeblservice包内的所有接口，并通过financedataservice和data层进行交互。PaymentBillTool对外提供查询和修改PaymentBill的方法的接口,ReceiptBillTool对外提供查询和修改ReceiptBill的方法的接口,CashBillTool对外提供查询和修改CashBill的方法的接口.而bussinesslogic.accountbl.AccountTool接口,bussinesslogic.clientbl.ClientTool接口,bussinesslogic.goodsbl.GoodsTool接口,bussinesslogic.logbl.LogTool接口是需要依赖的接口.

financebl模块的设计如图

![](pictures/financebl/financebl模块各个类的设计.png)

financebl模块各个类的职责如下表所示

| financebl模块的类 | 职责                  |
| ------------- | ------------------- |
| PaymentBill   | 负责实现制定付款单界面所需要的服务   |
| ReceiptBill   | 负责实现制定收款单界面所需要的服务   |
| CashBill      | 负责实现制定现金费用单界面所需要的服务 |

<br/>

#### (3) 模块内部类的接口规范
##### PaymentBill的接口规范
| 提供的服务（供接口）                               |      |                                          |
| ---------------------------------------- | ---- | ---------------------------------------- |
| `PaymentBillBlService.getID`             | 语法   | `public String getID()`                  |
|                                          | 前置条件 | 当日单据小于99999条                             |
|                                          | 后置条件 | 返回新的付款单单据编号                              |
| `PaymentBillBlService.getClientList`     | 语法   | `  public ArrayList<ClientVO> getClientList(ClientQueryVO query)` |
|                                          | 前置条件 | 编辑付款单时                                   |
|                                          | 后置条件 | 返回客户列表                                   |
| `PaymentBillBlService.getAccountList`    | 语法   | `  public ArrayList<AccountVO> getAccountList(AccountQueryVO query)` |
|                                          | 前置条件 | 编辑付款单时                                   |
|                                          | 后置条件 | 返回账户列表                                   |
| `PaymentBillBlService.submit`            | 语法   | `  public ResultMessage submit(PaymentBillVO vo)` |
|                                          | 前置条件 | 制定单据完成                                   |
|                                          | 后置条件 | 更新并提交付款单，持久化更新涉及的对象的数据                   |
| `PaymentBillBlService.saveDraft`         | 语法   | `  public ResultMessage saveDraft(PaymentBillVO vo)` |
|                                          | 前置条件 | 制定单据完成                                   |
|                                          | 后置条件 | 保存单据草稿                                   |
| `PaymentBillTool.pass`                   | 语法   | `public ResultMessage pass(PaymentBillVO bill)` |
|                                          | 前置条件 | 单据审批通过                                   |
|                                          | 后置条件 | 更新客户应收应付信息，更改账户信息，修改单据状态                 |
| `PaymentBillTool.reject`                 | 语法   | `public ResultMessage reject(PaymentBillVO bill)` |
|                                          | 前置条件 | 单据审批不通过                                  |
|                                          | 后置条件 | 修改单据状态为不通过                               |
| `PaymentBillBlService/PaymentBillTool.getPaymentBillList` | 语法   | `public ArrayList<PaymentBillVO> getPaymentBillList(BillQueryVO query)` |
|                                          | 前置条件 | 无                                        |
|                                          | 后置条件 | 取得收款单列表                                  |

| 需要的服务（需接口）                               |               |
| ---------------------------------------- | ------------- |
| 服务名                                      | 服务            |
| `PaymentBillDataService.find(BillQueryPO query)` | 根据筛选条件获取付款单列表 |
| `PaymentBillDataService.getID()`         | 得到新的付款单ID     |
| `PaymentBillDataService.insert(PaymentBillPO po)` | 添加付款单         |
| `PaymentBillDataService.update(PaymentBillPO po)` | 更新付款单信息       |
| `ClientTool.getClientList(ClientQueryVO query)` | 取得客户列表        |
| `AccountTool.getAccountList(AccountQueryVO query)` | 取得账户列表        |
| `LogTool.addLog(LogVO log)`              | 记录日志          |
| `ClientTool.editClient(ClientVO client)` | 更改客户信息        |
| `AccountTool.editAccount(AccountVO account)` | 更改账户信息        |

<br/>

##### ReceiptBill的接口规范
| 提供的服务（供接口）                               |      |                                          |
| ---------------------------------------- | ---- | ---------------------------------------- |
| `ReceiptBillBlService.getID`             | 语法   | `public String getID()`                  |
|                                          | 前置条件 | 当日单据小于99999条                             |
|                                          | 后置条件 | 返回新的收款单单据编号                              |
| `ReceiptBillBlService.getClientList`     | 语法   | `  public ArrayList<ClientVO> getClientList(ClientQueryVO query)` |
|                                          | 前置条件 | 编辑收款单时                                   |
|                                          | 后置条件 | 返回客户列表                                   |
| `ReceiptBillBlService.getAccountList`    | 语法   | `  public ArrayList<AccountVO> getAccountList(AccountQueryVO query)` |
|                                          | 前置条件 | 编辑收款单时                                   |
|                                          | 后置条件 | 返回账户列表                                   |
| `ReceiptBillBlService.submit`            | 语法   | `  public ResultMessage submit(ReceiptBillVO vo)` |
|                                          | 前置条件 | 制定单据完成                                   |
|                                          | 后置条件 | 更新并提交收款单，持久化更新涉及的对象的数据                   |
| `ReceiptBillBlService.saveDraft`         | 语法   | `  public ResultMessage saveDraft(ReceiptBillVO vo)` |
|                                          | 前置条件 | 制定单据完成                                   |
|                                          | 后置条件 | 保存单据草稿                                   |
| `ReceiptBillTool.pass`                   | 语法   | `public ResultMessage pass(ReceiptBillVO bill)` |
|                                          | 前置条件 | 单据审批通过                                   |
|                                          | 后置条件 | 更新客户应收应付信息，更改账户信息，修改单据状态                 |
| `ReceiptBillTool.reject`                 | 语法   | `public ResultMessage reject(ReceiptBillVO bill)` |
|                                          | 前置条件 | 单据审批不通过                                  |
|                                          | 后置条件 | 修改单据状态为不通过                               |
| `ReceiptBillBlService/ReceiptBillTool.getReceiptBillList` | 语法   | `public ArrayList<ReceiptBillVO> getReceiptBillList(BillQueryVO query)` |
|                                          | 前置条件 | 无                                        |
|                                          | 后置条件 | 取得收款单列表                                  |

| 需要的服务（需接口）                               |               |
| ---------------------------------------- | ------------- |
| 服务名                                      | 服务            |
| `ReceiptBillDataService.find(BillQueryPO query)` | 根据筛选条件获取收款单列表 |
| `ReceiptBillDataService.getID()`         | 得到新的收款单ID     |
| `ReceiptBillDataService.insert(ReceiptBillPO po)` | 添加收款单         |
| `ReceiptBillDataService.update(ReceiptBillPO po)` | 更新收款单信息       |
| `ClientTool.getClientList(ClientQueryVO query)` | 取得客户列表        |
| `AccountTool.getAccountList(AccountQueryVO query)` | 取得账户列表        |
| `LogTool.addLog(LogVO log)`              | 记录日志          |
| `ClientTool.editClient(ClientVO client)` | 更改客户信息        |
| `AccountTool.editAccount(AccountVO account)` | 更改账户信息        |

<br/>

##### CashBill的接口规范
| 提供的服务（供接口）                               |      |                                          |
| ---------------------------------------- | ---- | ---------------------------------------- |
| `CashBillBlService.getID`                | 语法   | `public String getID()`                  |
|                                          | 前置条件 | 当日单据小于99999条                             |
|                                          | 后置条件 | 返回新的现金费用单单据编号                            |
| `CashBillBlService.getGoodsList`         | 语法   | `  public ArrayList<GoodsVO> getGoodsList(GoodsQueryVO query)` |
|                                          | 前置条件 | 编辑现金费用单时                                 |
|                                          | 后置条件 | 返回商品列表                                   |
| `CashBillBlService.getAccountList`       | 语法   | `  public ArrayList<AccountVO> getAccountList(AccountQueryVO query)` |
|                                          | 前置条件 | 编辑现金费用单时                                 |
|                                          | 后置条件 | 返回账户列表                                   |
| `CashBillBlService.submit`               | 语法   | `  public ResultMessage submit(CashBillVO vo)` |
|                                          | 前置条件 | 制定单据完成                                   |
|                                          | 后置条件 | 更新并提交现金费用单，持久化更新涉及的对象的数据                 |
| `CashBillBlService.saveDraft`            | 语法   | `  public ResultMessage saveDraft(CashBillVO vo)` |
|                                          | 前置条件 | 制定单据完成                                   |
|                                          | 后置条件 | 保存单据草稿                                   |
| `CashBillTool.pass`                      | 语法   | `public ResultMessage pass(CashBillVO bill)` |
|                                          | 前置条件 | 单据审批通过                                   |
|                                          | 后置条件 | 更新更改账户信息，修改单据状态                          |
| `CashBillTool.reject`                    | 语法   | `public ResultMessage reject(CashBillVO bill)` |
|                                          | 前置条件 | 单据审批不通过                                  |
|                                          | 后置条件 | 修改单据状态为不通过                               |
| `CashBillBlService/CashBillTool.getCashBillList` | 语法   | `public ArrayList<CashBillVO> getCashBillList(BillQueryVO query)` |
|                                          | 前置条件 | 无                                        |
|                                          | 后置条件 | 取得现金费用单列表                                |

| 需要的服务（需接口）                               |                 |
| ---------------------------------------- | --------------- |
| 服务名                                      | 服务              |
| `CashBillDataService.find(BillQueryPO query)` | 根据筛选条件获取现金费用单列表 |
| `CashBillDataService.getID()`            | 得到新的现金费用单ID     |
| `CashBillDataService.insert(CashBillPO po)` | 添加现金费用单         |
| `CashBillDataService.update(CashBillPO po)` | 更新现金费用单信息       |
| `GoodsTool.getGoodsList(GoodsQueryVO query)` | 取得商品列表          |
| `AccountTool.getAccountList(AccountQueryVO query)` | 取得账户列表          |
| `LogTool.addLog(LogVO log)`              | 记录日志            |
| `AccountTool.editAccount(AccountVO account)` | 更改账户信息          |

<br/>

#### (4) 业务逻辑层的动态模型
如图表明了进销存管理系统中，当财务人员想要提交一份收款单的时候，制定收款单业务逻辑处理的相关对象之间的协作。

![](pictures/financebl/提交收款单的顺序图.png)

如图表明了进销存管理系统中，当财务人员想要为付款单添加账户的时候，制定付款单业务逻辑处理的相关对象之间的协作。

![](pictures/financebl/获取账户列表的顺序图.png)

如图所示的状态图描述了Finance对象的生存期间的状态序列、引起转移的事件，以及因状态转移而伴随的动作。

![](pictures/financebl/Finance对象状态图.png)

<br/>
<br/>
***********************************************
<br/>
<br/>

### 4.1.9 initialbl模块
#### (1) 模块概述
initialbl模块负责期初信息的查看和建账。具体功能需求和非功能需求可参见需求规格说明文档和体系结构设计文档。

<br/>

#### (2) 整体结构
根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们会添加接口。此包实现了initialblservice的所有方法，并通过initialdataservice与数据层交互。bussinesslogic.accountbl.AccountTool接口,bussinesslogic.clientbl.ClientTool接口,bussinesslogic.goodsbl.GoodsTool接口,bussinesslogic.logbl.LogTool接口是需要依赖的接口.

initialbl模块的设计如图

![](pictures/initialbl/initialbl模块各个类的设计.png)

initialbl模块各个类的职责如下表所示

| initialbl模块的类 | 职责               |
| ------------- | ---------------- |
| Initial       | 负责实现期初建账界面所需要的服务 |

<br/>

#### (3) 模块内部类的接口规范
##### Initial的接口规范
| 提供的服务（供接口）                        |      |                                          |
| --------------------------------- | ---- | ---------------------------------------- |
| `Initial.getYear`                 | 语法   | `public String getYear()`                |
|                                   | 前置条件 | 无                                        |
|                                   | 后置条件 | 返回期初信息列表                                 |
| `InitialBlService.getGoodsList`   | 语法   | `    public ArrayList<GoodsVO> getGoodsList(GoodsQueryVO query)` |
|                                   | 前置条件 | 无                                        |
|                                   | 后置条件 | 返回上一年的持久化商品对象                            |
| `InitialBlService.getClientList`  | 语法   | `    public ArrayList<ClientVO> getClientList(ClientQueryVO query)` |
|                                   | 前置条件 | 无                                        |
|                                   | 后置条件 | 返回上一年的持久化客户对象                            |
| `InitialBlService.getAccountList` | 语法   | `    public ArrayList<AccountVO> getAccountList(AccountQueryVO query)` |
|                                   | 前置条件 | 输入的时间合法                                  |
|                                   | 后置条件 | 返回上一年的持久化账户对象                            |
| `InitialBlService.addInitial`     | 语法   | `public ResultMessage establishInitial(initialVO initial)` |
|                                   | 前置条件 | 输入的商品、客户、账户对象合法                          |
|                                   | 后置条件 | 保存期初信息，持久化更新涉及的对象的数据                     |
| `InitialBlService.getInitialList` | 语法   | `public ArrayList<InitialVO> getInitial(InitialQueryVO query)` |
|                                   | 前置条件 | 无                                        |
|                                   | 后置条件 | 返回期初信息列表                                 |

| 需要的服务（需接口）                               |           |
| ---------------------------------------- | --------- |
| 服务名                                      | 服务        |
| `InitialDataService.insert(InitialPO po)` | 添加起初信息    |
| `InitialDataService.find(InitialQueryPO query)` | 获取持久化对象列表 |
| `ClientTool.getClientList(ClientQueryVO query)` | 取得客户列表    |
| `AccountTool.getAccountList(AccountQueryVO query)` | 取得账户列表    |
| `GoodsTool.getGoodsList(GoodsQueryVO query)` | 取得商品列表    |
| `LogTool.addLog(LogVO log)`              | 记录日志      |

<br/>

#### (4) 业务逻辑层的动态模型
如图表明了进销存管理系统中，当财务人员想要查看期初信息的时候，期初建账业务逻辑处理的相关对象之间的协作。

![](pictures/initialbl/查看期初信息的顺序图.png)

如图表明了进销存管理系统中，当财务人员想要建账的时候，期初建账业务逻辑处理的相关对象之间的协作。

![](pictures/initialbl/期初建账的顺序图.png)

如图所示的状态图描述了Initial对象的生存期间的状态序列、引起转移的事件，以及因状态转移而伴随的动作。

![](pictures/initialbl/Initial对象状态图.png)

<br/>
<br/>
***********************************************
<br/>
<br/>

### 4.1.10 logbl模块
#### (1) 模块概述
logbl模块包含了日志功能的业务逻辑代码。具体功能需求和非功能需求可参见需求规格说明文档和体系结构设计文档。

<br/>

#### (2) 整体结构
根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们会添加接口。比如展示层和业务逻辑层之间，我们添加logblservice.LogBlService接口。业务逻辑层和数据层之间添加logdataservice.LogDataService接口。LogTool是对外提供修改Log对象的方法的接口.

logbl模块的设计如图

![](pictures/logbl/logbl模块各个类的设计.png)

logbl模块各个类的职责如下表所示

| logbl模块的类 | 职责                 |
| --------- | ------------------ |
| Log       | 负责实现查看操作日志界面所需要的服务 |

<br/>

#### (3) 模块内部类的接口规范
##### Log的接口规范
| 提供的服务（供接口）                    |      |                                          |
| ----------------------------- | ---- | ---------------------------------------- |
| `LogBlService.getLogList`     | 语法   | `public ArrayList<LogVO> getLogList(LogQueryVO query)` |
|                               | 前置条件 | 无                                        |
|                               | 后置条件 |                                          |
| `LogBlService/LogTool.addLog` | 语法   | `    public ResultMessage addLog(LogVO log)` |
|                               | 前置条件 | 输入的操作者、行为、时间点合法                          |
|                               | 后置条件 | 添加操作日志，持久化更新涉及的对象的数据                     |

| 需要的服务（需接口）                              |               |
| --------------------------------------- | ------------- |
| `LogDataService.find(LogQueryPO query)` | 根据筛选条件查找符合的日志 |
| `LogDataService.insert(LogPO po)`       | 插入日志          |
| `LogDataService.update(LogPO po)`       | 更新日志          |

<br/>

#### (4) 业务逻辑层的动态模型
如图表明了进销存管理系统中，当财务人员或者总经理想要查看操作日志的时候，查看操作日志业务逻辑处理的相关对象之间的协作。

![](pictures/logbl/查看操作日志的顺序图.png)

如图所示的状态图描述了Log对象的生存期间的状态序列、引起转移的事件，以及因状态转移而伴随的动作。

![](pictures/logbl/Log对象状态图.png)

<br/>
<br/>
***********************************************
<br/>
<br/>

### 4.1.11 reportbl模块
#### (1) 模块描述
reportbl模块负责销售明细表，经营历程表和经营情况表的查看，详细过程参见需求规格说明文档和体系结构设计文档。

<br/>

#### (2) 整体结构
采用分层结构，将系统分为UI层，逻辑层（调用其他逻辑层的接口，无自身对应的数据）。为扩展灵活，清楚业务，在层间设置了接口。

reportbl模块的设计图

![](pictures/reportbl/reportbl模块图.png)

reportbl模块各个类的职责如下表所示:

| reportbl模块的类      | 职责               |
| ----------------- | ---------------- |
| SaleDetail        | 负责实现构造销售明细表所需的服务 |
| BusinessHistory   | 负责实现构造经营历程表所需的服务 |
| BusinessCondition | 负责实现构造经营情况表所需的服务 |

<br/>

#### (3) 模块内部类的接口规范
##### SaleDetail的接口规范
| 提供的服务（供接口）                              |      |                                          |
| --------------------------------------- | ---- | ---------------------------------------- |
| `SaLeDetailBlService.getSaleRecordList` | 语法   | `public ArrayList<SaleRecord> getSaleRecordList(SaleDetailQueryVO query)` |
|                                         | 前置条件 | 无                                        |
|                                         | 后置条件 | 系统返回符合筛选条件的所有商品销售记录                      |

| 需要的服务（需接口）                               |         |
| ---------------------------------------- | ------- |
| 服务名                                      | 服务      |
| `SaleTradeBillTool.getSaleTradeBillList(BillQueryVO query)` | 返回销售单列表 |

<br/>

##### BusinessHistory的接口规范
| 提供的服务（供接口）                             |      |                                          |
| -------------------------------------- | ---- | ---------------------------------------- |
| `BusinessHistoryBlService.getBillList` | 语法   | `public ArrayList<BillVO> getBillList(BusinessHistoryQueryVO query)` |
|                                        | 前置条件 | 无                                        |
|                                        | 后置条件 | 系统返回符合筛选条件的所有单据                          |

| 需要的服务（需接口）                               |           |
| ---------------------------------------- | --------- |
| 服务名                                      | 服务        |
| `PurchaseTradeBillTool.getPurchaseTradeBillList(BillQueryVO query)` | 返回进货单列表   |
| `PurchaseRefundBillTool.getPurchaseRefundBillList(BillQueryVO query)` | 返回进货退货单列表 |
| `SaleTradeBillTool.getSaleTradeBillList(BillQueryVO query)` | 返回销售单列表   |
| `SaleRefundBillTool.getSaleRefundBillList(BillQueryVO query)` | 返回销售退货单列表 |
| `PaymentBillTool.getPaymentBillList(BillQueryVO query)` | 返回付款单列表   |
| `ReceiptBillTool.getReceiptBillList(BillQueryVO query)` | 返回收款单列表   |
| `CashBillTool.getCashBillList(BillQueryVO query)` | 返回现金费用单列表 |
| `InventoryLossOverBillTool.getInventoryLossOverBillList(BillQueryVO query)` | 返回库存溢损单列表 |
| `InventoryGiftBillTool.getInventoryGiftBillList(BillQueryVO query)` | 返回库存赠送单列表 |

<br/>

##### BusinessCondition的接口规范
| 提供的服务（供接口）                               |      |                                          |
| ---------------------------------------- | ---- | ---------------------------------------- |
| `BusinessConditionBlService.getCondition` | 语法   | `public ArrayList<double> getCondition(BusinessConditionQueryVO query)` |
|                                          | 前置条件 | 无                         |
|                                          | 后置条件 | 系统返回符合筛选条件的经营情况                         |

| 需要的服务（需接口）                               |           |
| ---------------------------------------- | --------- |
| 服务名                                      | 服务        |
| `PurchaseTradeBillTool.getPurchaseTradeBillList(BillQueryVO query)` | 返回进货单列表   |
| `PurchaseRefundBillTool.getPurchaseRefundBillList(BillQueryVO query)` | 返回进货退货单列表 |
| `SaleTradeBillTool.getSaleTradeBillList(BillQueryVO query)` | 返回销售单列表   |
| `SaleRefundBillTool.getSaleRefundBilList(BillQueryVO query)` | 返回销售退货单列表 |
| `CashBillTool.getCashBillList(BillQueryVO query)` | 返回现金费用单列表 |
| `InventoryLossOverBillTool.getInventoryLossOverBillList(BillQueryVO query)` | 返回库存溢损单列表 |
| `InventoryGiftBillTool.getInventoryGiftBillList(BillQueryVO query)` | 返回库存赠送单列表 |

<br/>

#### (4) 业务逻辑层的动态模型

如图为查看销售明细表的顺序图

![](pictures/reportbl/查看销售明细表顺序图.png)

<br/>
<br/>
***********************************************
<br/>
<br/>

### 4.1.12 approvalbl模块
#### (1) 模块描述
approvalbl模版负责审批单据业务，详细过程参见需求规格说明文档和体系结构设计文档。

<br/>

#### (2) 整体结构
采用分层结构，将系统分为UI层，逻辑层（调用其他逻辑层的接口，无自身对应的数据）。为扩展灵活，清楚业务，在层间设置了接口。

approvalbl模块的设计图

![](pictures/approvalbl/approvalbl模块图.png)

approval模版中各个类的职责

| approvalbl模块的类 | 职责           |
| -------------- | ------------ |
| Approval       | 负责审批单据的所需的业务 |

<br/>

#### (3) 模块内部类的接口规范
#### Approval的接口规范

| 提供的服务（供接口）                      |      |                                          |
| ------------------------------- | ---- | ---------------------------------------- |
| `ApprovalBlService.getBillList` | 语法   | `public ArrayList<BillVO> getBillList(BillQueryVO query)` |
|                                 | 前置条件 | 无                                        |
|                                 | 后置条件 | 系统显示该类型的提交单据                             |
| `ApprovalBlService.pass`        | 语法   | `public ResultMessage pass(ArrayList<BillVO> vo)` |
|                                 | 前置条件 | vo属性正确                                   |
|                                 | 后置条件 | 系统修改单据的数据及状态                             |
| `ApprovalBlService.reject`      | 语法   | `public ResultMessage reject(BillVO vo, String result)` |
|                                 | 前置条件 | 无                                        |
|                                 | 后置条件 | 系统修改单据的状态                                |

| 需要的服务（需接口）                               |            |
| ---------------------------------------- | ---------- |
| 服务名                                      | 服务         |
| `PurchaseTradeBillTool.getPurchaseTradeBillList(BillQueryVO query)` | 返回进货单列表    |
| `PurchaseRefundBillTool.getPurchaseRefundBillList(BillQueryVO query)` | 返回进货退货单列表  |
| `SaleTradeBillTool.getSaleTradeBillList(BillQueryVO query)` | 返回销售单列表    |
| `SaleRefundBillTool.getSaleRefundBilList(BillQueryVO query)` | 返回销售退货单列表  |
| `CashBillTool.getCashBillList(BillQueryVO query)` | 返回现金费用单列表  |
| `InventoryLossOverBillTool.getInventoryLossOverBillList(BillQueryVO query)` | 返回库存溢损单列表  |
| `InventoryGiftBillTool.getInventoryGiftBillList(BillQueryVO query)` | 返回库存赠送单列表  |
| `PurchaseTradeBillTool.pass(PurchaseTradeBillVO vo)` | 进货单审批通过    |
| `PurchaseRefundBillTool.pass(PurchaseRefundBillVO vo)` | 进货退货单审批通过  |
| `SaleTradeBillTool.pass(SaleTradeBillVO vo)` | 销售单审批通过    |
| `SaleRefundBillTool.pass(SaleRefundBillVO vo)` | 销售退货单审批通过  |
| `PaymentBillTool.pass(PaymentBillVO vo)` | 付款单审批通过    |
| `ReceiptBillTool.pass(ReceiptBillVO vo)` | 收款单审批通过    |
| `CashBillTool.pass(CashBillVO vo)`       | 现金费用单审批通过  |
| `InventoryLossOverBillTool.pass(InventoryLossOverBillVO vo)` | 库存溢损单审批通过  |
| `InventoryGiftBillTool.pass(InventoryGiftBillVO vo)` | 库存赠送单审批通过  |
| `PurchaseTradeBillTool.reject(PurchaseTradeBillVO vo)` | 进货单审批不通过   |
| `PurchaseRefundBillTool.reject(PurchaseRefundBillVO vo)` | 进货退货单审批不通过 |
| `SaleTradeBillTool.reject(SaleTradeBillVO vo)` | 销售单审批不通过   |
| `SaleRefundBillTool.reject(SaleRefundBillVO vo)` | 销售退货单审批不通过 |
| `PaymentBillTool.reject(PaymentBillVO vo)` | 付款单审批不通过   |
| `ReceiptBillTool.reject(ReceiptBillVO vo)` | 收款单审批不通过   |
| `CashBillTool.reject(CashBillVO vo)`     | 现金费用单审批不通过 |
| `InventoryLossOverBillTool.reject(InventoryLossOverBillVO vo)` | 库存溢损单审批不通过 |
| `InventoryGiftBillTool.reject(InventoryGiftBillVO vo)` | 库存赠送单审批不通过 |
| `LogTool.addLog(LogVO log)`              | 记录日志       |
| `MessageTool.addMessage(MessageVO message)` | 添加系统信息     |

<br/>

#### (4) 业务逻辑层的动态模型
如图为单据审批通过的顺序图

![](pictures/approvalbl/单据审批通过顺序图.png)

如图为单据审批不通过的顺序图

![](pictures/approvalbl/单据审批不通过顺序图.png)

<br/>
<br/>
***********************************************
<br/>
<br/>

### 4.1.13 promotionbl模块
#### (1) 模块描述
promotionbl模块负责促销策略的管理，详细过程参见需求规格说明文档和体系结构设计文档。

<br/>

#### (2) 整体结构
采用分层结构，将系统分为UI层，逻辑层和数据层。为扩展灵活，清楚业务，在层间设置了接口。

promotiontbl模块的设计图

![](pictures/promotionbl/promotionbl模块图.png)

promotion模块各个类的职责如下表所示

| promotionbl模块的类 | 职责               |
| --------------- | ---------------- |
| Promotion       | 负责实现促销策略管理所需要的服务 |

<br/>

#### (3) 模块内部类的接口规范
##### Promotion的接口规范
| 提供的服务（供接口）                               |      |                                          |
| ---------------------------------------- | ---- | ---------------------------------------- |
| `PromotionBlService/PromotionTool.getPromotionList` | 语法   | `public ArrayList<PromotionVO> getPromotionList(PromotionQueryVO query)` |
|                                          | 前置条件 | 无                                        |
|                                          | 后置条件 | 系统显示所有促销策略                               |
| `Promotion.addPromotion`                 | 语法   | `public ResultMessage add(PromotionVO vo)` |
|                                          | 前置条件 | vo属性正确                                   |
|                                          | 后置条件 | 系统新增促销策略                                 |
| `Promotion.editPromotion`                | 语法   | `public ResultMessage editPromotion(PromotionVO vo)` |
|                                          | 前置条件 | vo属性正确                                   |
|                                          | 后置条件 | 系统修改促销策略                                 |
| `Promotion.deletePromotion`              | 语法   | `public ResultMessage deletePromotion(PromotionVO vo)` |
|                                          | 前置条件 | 无                                        |
|                                          | 后置条件 | 系统删除促销策略                                 |
| `Promotion.getID`                        | 语法   | `public String getID()`                  |
|                                          | 前置条件 | 无                                        |
|                                          | 后置条件 | 返回新促销策略的编号                               |

| 需要的服务（需接口）                               |              |
| ---------------------------------------- | ------------ |
| 服务名                                      | 服务           |
| `PromotionDataService.find(PromotionQueryPO query)` | 根据筛选条件查找促销策略 |
| `PromotionDataService.insert(PromotionPO po)` | 插入单一持久化对象    |
| `PromotionDataService.delete(PromotionPO po)` | 删除单一持久化对象    |
| `PromotionDataService.update(PromotionPO po)` | 更新单一持久化对象    |
| `PromotionDataService.getPromotionID()`  | 得到新的促销策略ID   |
| `LogTool.addLog(LogVO log)`              | 记录日志         |
| `MessageTool.addMessage(MessageVO message)` | 添加系统信息       |

<br/>

#### (4) 业务逻辑层的动态模型
如图为增加促销策略的顺序图

![](pictures/promotionbl/添加促销策略顺序图.png)

如图为更新促销策略的顺序图

![](pictures/promotionbl/修改促销策略顺序图.png)

如图为促销策略的状态图

![](pictures/promotionbl/Promotion对象状态图.png)

<br/>
<br/>
***********************************************
<br/>
<br/>

### 4.1.14 userbl模块
#### (1) 模块描述
userbl模版负责帐号管理的管理，详细过程参见需求规格说明文档和体系结构设计文档。

<br/>

#### (2) 整体结构
采用分层结构，将系统分为UI层，逻辑层和数据层。为扩展灵活，清楚业务，在层间设置了接口。

usertbl模块的设计图

![](pictures/userbl/userbl模块图.png)

user模块各个类的职责如下表所示

| userbl模块的类 | 职责             |
| ---------- | -------------- |
| User       | 负责实现帐号管理所需要的服务 |

<br/>

#### (3) 模块内部类的接口规范
##### User的接口规范
| 提供的服务（供接口）                           |      |                                          |
| ------------------------------------ | ---- | ---------------------------------------- |
| `UserBlService/UserTool.getUserList` | 语法   | `public ArrayList<UserVo> getUserList(UserQueryVO query)` |
|                                      | 前置条件 | 正在进行用户管理                                 |
|                                      | 后置条件 | 返回用户列表                                   |
| `UserBlService.addUser`              | 语法   | `public ResultMessage addUser(UserVO user)` |
|                                      | 前置条件 | 正在进行用户管理                                 |
|                                      | 后置条件 | 添加一个用户，更新用户列表                            |
| `UserBlService/UserTool.editUser`    | 语法   | `public ResultMessage editUser(UserVO user)` |
|                                      | 前置条件 | 正在进行用户管理                                 |
|                                      | 后置条件 | 编辑一个用户，更新用户列表                            |
| `UserBlService.deleteUser`           | 语法   | `public ResultMessage deleteUser(UserVO user)` |
|                                      | 前置条件 | 正在进行用户管理                                 |
|                                      | 后置条件 | 删除一个用户，更新用户列表                            |
| `UserBlService.getUserID`            | 语法   | `public String getUserID()`              |
|                                      | 前置条件 | 新建用户时                                    |
|                                      | 后置条件 | 返回一个新的用户ID                               |

| 需要的服务（需接口）                               |           |
| ---------------------------------------- | --------- |
| 服务名                                      | 服务        |
| `UserDataService.find(UserQueryPO query)`                 | 取得所有用户的列表 |
| `UserDataService.insert(UserPO po)`      | 添加用户      |
| `UserDataService.delete(UserPO po)`      | 删除用户      |
| `UserDataService.update(UserPO po)`      | 更改用户信息    |
| `UserDataService.getUserID()`            | 得到新的用户ID  |
| `LogTool.addLog(LogVO log)`              | 记录日志      |
| `MessageTool.addMessage(MessageVO message)` | 添加系统信息    |

<br/>

#### (4)业务逻辑的动态模型
如图为增加帐号的顺序图

![](pictures/userbl/添加帐号顺序图.png)

如图为更新帐号的顺序图

![](pictures/userbl/修改帐号顺序图.png)

如图为帐号的状态图

![](pictures/userbl/user对象状态图.png)

<br/>
<br/>
***********************************************
<br/>
<br/>

### 4.1.15 loginbl模块
#### (1) 模块概述
loginbl模块负责登陆操作的业务实现。具体功能需求和非功能需求可参见需求规格说明文档和体系结构设计文档。

<br/>

#### (2) 整体结构
根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们会添加接口。比如展示层和业务逻辑层之间，我们添加loginblservice.LoginBLlervice接口。业务逻辑层和数据层之间添加logindataservice.LoginDataService接口。

loginbl模块的设计如图

![](pictures/loginbl/loginbl模块各个类的设计.png)

loginbl模块各个类的职责如下表所示：

| loginbl模块的类 | 职责           |
| ----------- | ------------ |
| Login       | 负责登陆界面所需要的服务 |

<br/>

#### (3) 模块内部类的接口规范
##### Login的接口规范
| 提供的服务（供接口）             |      |                                          |
| ---------------------- | ---- | ---------------------------------------- |
| `LoginBlService.login` | 语法   | `public UserVO login(String ID, String password)` |
|                        | 前置条件 | 在登陆界面                                    |
|                        | 后置条件 | 根据用户名和密码返回客户信息                           |

| 需要的服务（需接口）                               |              |
| ---------------------------------------- | ------------ |
| 服务名                                      | 服务           |
| `LoginDataService.login(String ID,String password)` | 根据用户名和密码取得用户 |

<br/>

#### (4) 业务逻辑层的动态模型
如图表明了进销存管理系统中，当用户界面刷新系统信息的时候，客户管理业务逻辑处理的相关对象之间的协作。

![](pictures/loginbl/登录的顺序图.png)

如图所示的状态图描述了Message对象生存期间的状态序列、引起转移的事件，以及因状态转移而伴随的动作。

![](pictures/loginbl/Login对象状态图.png)


<br/>
<br/>
***********************************************
<br/>
<br/>

### 4.1.16 messagebl模块
#### (1) 模块概述
messagebl模块登陆操作以及取得系统信息。具体功能需求和非功能需求可参见需求规格说明文档和体系结构设计文档。

<br/>

#### (2) 整体结构
根据体系结构的设计，我们将系统分为展示层、业务逻辑层、数据层。每一层之间为了增加灵活性，我们会添加接口。比如展示层和业务逻辑层之间，我们添加bussinesslogicservice.MessageBLlervice接口。业务逻辑层和数据层之间添加dataservice.MessageDataService接口。MessagePO是作为系统信息的持久化对象被添加到设计模型中去的。

messagebl模块的设计如图

![](pictures/messagebl/messagebl模块各个类的设计.png)

messagebl模块各个类的职责如下表所示：

| messagebl模块的类 | 职责             |
| ------------- | -------------- |
| Message       | 负责系统信息界面所需要的服务 |

<br/>

#### (3) 模块内部类的接口规范
##### Message的接口规范
| 提供的服务（供接口）                        |      |                                          |
| --------------------------------- | ---- | ---------------------------------------- |
| `MessageBlService.getMessageList` | 语法   | `public Arraylist<MessageVO> getMessageList(UserVO receiver)` |
|                                   | 前置条件 | 在各个用户的主界面                                |
|                                   | 后置条件 | 根据接收者，返回系统信息                             |
| `MessageTool.addMessage`          | 语法   | `public Result addMessage(MessageVO message)` |
|                                   | 前置条件 | 增加给某一用户的信息                               |
|                                   | 后置条件 | 更新持久化数据                                  |

| 需要的服务（需接口）                               |            |
| ---------------------------------------- | ---------- |
| 服务名                                      | 服务         |
| `MessageDataService.find(UserPO receiver)`   | 取得该用户的系统信息 |
| `MessageDataService.insert(MessagePO message)` | 新增系统消息     |

<br/>

#### (4) 业务逻辑层的动态模型
如图表明了进销存管理系统中，当用户界面刷新系统信息的时候，客户管理业务逻辑处理的相关对象之间的协作。

![](pictures/messagebl/刷新系统信息的顺序图.png)

如图所示的状态图描述了Message对象生存期间的状态序列、引起转移的事件，以及因状态转移而伴随的动作。

![](pictures/messagebl/Message对象状态图.png)
